import{C as L,D as c,E as O,G as U,H as x,r as g,o as R,e as h,I as f,g as v,F as V,J as q,t as y,f as B,c as d}from"./CQW9o_Bo.js";import{u as G}from"./CwWP08B6.js";function E(u,r,a){const[t={},l]=typeof r=="string"?[{},r]:[r,a],e=L(()=>c(u)),o=t.key||O([l,typeof e.value=="string"?e.value:"",...I(t)]);if(!o||typeof o!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+o);if(!u)throw new Error("[nuxt] [useFetch] request is missing.");const s=o===l?"$f"+o:o;if(!t.baseURL&&typeof e.value=="string"&&e.value[0]==="/"&&e.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:m,lazy:i,default:D,transform:j,pick:A,watch:b,immediate:F,getCachedData:J,deep:$,dedupe:C,...N}=t,_=U({...x,...N,cache:typeof t.cache=="boolean"?void 0:t.cache}),T={server:m,lazy:i,default:D,transform:j,pick:A,immediate:F,getCachedData:J,deep:$,dedupe:C,watch:b===!1?[]:[_,e,...b||[]]};let n;return G(s,()=>{var k;(k=n==null?void 0:n.abort)==null||k.call(n),n=typeof AbortController<"u"?new AbortController:{};const w=c(t.timeout);let p;return w&&(p=setTimeout(()=>n.abort(),w),n.signal.onabort=()=>clearTimeout(p)),(t.$fetch||globalThis.$fetch)(e.value,{signal:n.signal,..._}).finally(()=>{clearTimeout(p)})},T)}function I(u){var a;const r=[((a=c(u.method))==null?void 0:a.toUpperCase())||"GET",c(u.baseURL)];for(const t of[u.params||u.query]){const l=c(t);if(!l)continue;const e={};for(const[o,s]of Object.entries(l))e[c(o)]=c(s);r.push(e)}return r}const M=B("h1",null,"Liste des emplois",-1),S={key:0},z={key:1},H={key:2},X={__name:"emplois",setup(u){const r=g([]),a=g(null),t=g(!0);return R(async()=>{t.value=!0;try{console.log("Fetching auth token...");const{data:e,error:o}=await E("/api/auth","$M7ikOQwRVk");if(console.log("Auth data:",e.value),console.log("Auth error:",o.value),o.value)throw console.error("Auth error:",o.value),new Error(`Auth error: ${o.value.message||"Unknown error"}`);if(!e.value)throw console.error("Auth error: No auth data returned"),new Error("Auth error: No auth data returned");const s=e.value.access_token;console.log("Fetching jobs...");const{data:m,error:i}=await E("/api/jobs",{params:{access_token:s}},"$6ublNicDgd");if(console.log("Jobs data:",m.value),console.log("Jobs error:",i.value),i.value)throw console.error("Jobs error:",i.value),new Error(`Jobs error: ${i.value.message||"Unknown error"}`);if(!m.value)throw console.error("Jobs error: No jobs data returned"),new Error("Jobs error: No jobs data returned");r.value=m.value.companies}catch(e){console.error("Error fetching jobs:",e),a.value=e.message}finally{t.value=!1}}),(e,o)=>(d(),h("div",null,[M,f(t)?(d(),h("div",S,"Chargement...")):v("",!0),!f(t)&&!f(a)?(d(),h("ul",z,[(d(!0),h(V,null,q(f(r),s=>(d(),h("li",{key:s.siret},y(s.name)+" - "+y(s.city),1))),128))])):v("",!0),f(a)?(d(),h("div",H,y(f(a)),1)):v("",!0)]))}};export{X as default};
